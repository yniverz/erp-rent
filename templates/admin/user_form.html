{% extends "admin/base.html" %}

{% block title %}{{ 'Benutzer bearbeiten' if user else 'Benutzer hinzufügen' }} - Verwaltung{% endblock %}

{% block content %}
<h1>{{ 'Benutzer bearbeiten: ' + user.username if user else 'Neuen Benutzer hinzufügen' }}</h1>

<div class="card">
    <form method="POST">
        {% if not user %}
        <div class="form-group">
            <label>Benutzername *</label>
            <input type="text" name="username" required>
        </div>
        {% endif %}

        <div class="form-group">
            <label>{{ 'Neues Passwort (leer lassen, um aktuelles beizubehalten)' if user else 'Passwort *' }}</label>
            <input type="password" name="password" {{ '' if user else 'required' }}>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Anzeigename</label>
                <input type="text" name="display_name" value="{{ user.display_name if user else '' }}">
            </div>
            <div class="form-group">
                <label>Email</label>
                <input type="email" name="email" value="{{ user.email if user else '' }}">
            </div>
        </div>

        <div class="form-group">
            <div class="checkbox-group">
                <input type="checkbox" name="is_admin" id="is_admin" {{ 'checked' if user and user.is_admin }}>
                <label for="is_admin" style="margin:0; font-weight:normal;">Admin</label>
            </div>
            <small style="color:#6b7280;">Admins können Benutzer, Einstellungen und alle Artikel verwalten.</small>
        </div>

        <div class="form-group">
            <div class="checkbox-group">
                <input type="checkbox" name="can_edit_all" id="can_edit_all" {{ 'checked' if user and user.can_edit_all }}>
                <label for="can_edit_all" style="margin:0; font-weight:normal;">Kann alle Artikel bearbeiten</label>
            </div>
            <small style="color:#6b7280;">Erlaubt das Bearbeiten von Artikeln anderer Benutzer (ohne volle Admin-Rechte).</small>
        </div>

        {% if user %}
        <div class="form-group">
            <div class="checkbox-group">
                <input type="checkbox" name="active" id="active" {{ 'checked' if user.active }}>
                <label for="active" style="margin:0; font-weight:normal;">Konto aktiv</label>
            </div>
            <small style="color:#6b7280;">Inaktive Konten können sich nicht anmelden.</small>
        </div>
        {% endif %}

        <div style="display: flex; gap: 10px; margin-top: 24px;">
            <button type="submit" class="btn btn-primary">{{ 'Benutzer aktualisieren' if user else 'Benutzer erstellen' }}</button>
            <a href="{{ url_for('admin.user_list') }}" class="btn btn-outline">Abbrechen</a>
        </div>
    </form>
</div>
{% endblock %}
